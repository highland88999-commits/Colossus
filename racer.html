<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Neon Star Racer: 60-Second Challenge</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;700&display=swap');
        @import url('https://fonts.googleapis.com/css2?family=VT323&display=swap');

        :root {
            --color-primary-pink: #ff00ff;
            --color-secondary-cyan: #00e0ff;
            --color-background: #0d0d1a;
            --color-gold: #FFD700;
            --color-score-red: #ff3333;
            --color-timer-green: #33ff33;
        }

        * { margin:0; padding:0; box-sizing:border-box; }
        html, body {
            height: 100%;
            background-color: var(--color-background);
            color: var(--color-secondary-cyan);
            font-family: 'Inter', sans-serif;
            overflow: hidden;
        }

        body {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            position: relative;
        }

        @keyframes shake {
            0%, 100% { transform: translate(0, 0); }
            20%, 60% { transform: translate(-5px, -5px); }
            40%, 80% { transform: translate(5px, 5px); }
        }
        .shake-active {
            animation: shake 0.3s cubic-bezier(.36,.07,.19,.97) both;
        }

        body::before {
            content: '';
            position: fixed;
            inset: 0;
            background-image:
                linear-gradient(to bottom, rgba(255,0,255,0.1), transparent 50%),
                repeating-linear-gradient(0deg, transparent, transparent 10px, rgba(0,224,255,0.05) 10px, rgba(0,224,255,0.05) 11px),
                repeating-linear-gradient(90deg, transparent, transparent 10px, rgba(0,224,255,0.05) 10px, rgba(0,224,255,0.05) 11px);
            background-size: 100% 100%, 100% 100px, 100px 100%;
            opacity: 0.8;
            z-index: -1;
            pointer-events: none;
        }

        .container {
            width: 100%;
            max-width: 600px;
            height: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 1rem;
        }

        h1 {
            font-family: 'VT323', monospace;
            color: var(--color-primary-pink);
            text-shadow: 0 0 10px var(--color-primary-pink);
            font-size: clamp(2rem, 8vw, 3.5rem);
            margin: 0.5rem 0;
        }

        #gameCanvas {
            width: 100%;
            max-width: 400px;
            aspect-ratio: 3 / 5;
            border: 2px solid var(--color-secondary-cyan);
            background: linear-gradient(to bottom, #1a0033, #0d0d1a);
            box-shadow: 0 0 20px var(--color-secondary-cyan);
            touch-action: none;
            cursor: crosshair;
            border-radius: 8px;
        }

        .controls { margin: 1rem 0; }

        .btn {
            background: linear-gradient(45deg, var(--color-gold), #9B59B6);
            border: none;
            color: #fff;
            padding: 0.8rem 1.8rem;
            font-size: 1.1rem;
            font-family: 'Inter', sans-serif;
            cursor: pointer;
            box-shadow: 0 0 8px var(--color-gold), 0 0 15px #9B59B6;
            transition: all 0.2s ease;
            text-transform: uppercase;
            border-radius: 6px;
            margin: 0.5rem;
        }
        .btn:hover { transform: scale(1.05); box-shadow: 0 0 20px var(--color-gold); }

        #scoreDisplay {
            font-family: 'VT323', monospace;
            font-size: clamp(1.8rem, 6vw, 2.5rem);
            color: var(--color-score-red);
            text-shadow: 0 0 8px var(--color-score-red);
            margin: 0.5rem 0;
        }

        #timerDisplay {
            position: absolute;
            top: 1rem;
            right: 1rem;
            font-family: 'VT323', monospace;
            font-size: clamp(1.4rem, 5vw, 2rem);
            color: var(--color-timer-green);
            text-shadow: 0 0 8px var(--color-timer-green);
            background: rgba(0,0,0,0.5);
            padding: 0.4rem 0.8rem;
            border-radius: 6px;
            z-index: 50;
        }

        .modal, #creditsScreen {
            position: fixed;
            inset: 0;
            background: rgba(0,0,0,0.92);
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 100;
            color: var(--color-secondary-cyan);
            font-family: 'VT323', monospace;
            cursor: pointer;
        }

        .modal-content {
            background: rgba(13,13,26,0.95);
            border: 3px solid var(--color-primary-pink);
            box-shadow: 0 0 40px var(--color-primary-pink);
            padding: 2rem;
            text-align: center;
            border-radius: 12px;
            max-width: 90%;
        }

        #creditsScreen {
            background: linear-gradient(to bottom, #0a001a, #000);
            justify-content: flex-end;
            padding-bottom: 2rem;
        }

        #creditsContent {
            position: absolute;
            bottom: -100%;
            width: 100%;
            text-align: center;
            font-size: clamp(1.6rem, 5vw, 2.8rem);
            color: var(--color-primary-pink);
            text-shadow: 0 0 15px var(--color-primary-pink), 0 0 30px #000;
            animation: rollCredits 18s linear forwards;
            pointer-events: none;
        }

        @keyframes rollCredits {
            0%   { transform: translateY(100vh); }
            100% { transform: translateY(-120%); }
        }

        #skipText {
            position: absolute;
            bottom: 1rem;
            font-size: 1.3rem;
            color: var(--color-secondary-cyan);
            text-shadow: 0 0 10px var(--color-secondary-cyan);
            opacity: 0.9;
        }
    </style>
</head>
<body>

    <div class="container">
        <h1>NEON STAR RACER</h1>
        <div id="timerDisplay" style="display: none;">TIME: 60</div>
        <div id="scoreDisplay">Score: 0</div>
        <canvas id="gameCanvas"></canvas>
        <div class="controls">
            <button id="startButton" class="btn">Start Race</button>
        </div>
    </div>

    <div id="gameOverModal" class="modal">
        <div class="modal-content">
            <h2 id="modalTitle">RACE COMPLETE!</h2>
            <p>Final Score: <span id="finalScore">0</span></p>
            <button class="btn" onclick="hideModalAndRestart()">Restart Race</button>
        </div>
    </div>

    <div id="creditsScreen" class="modal">
        <div id="creditsContent">
            <p>NEON STAR RACER</p>
            <p>-------------------</p>
            <p>A 60-SECOND ENDURANCE CHALLENGE</p>
            <p>-------------------</p>
            <p>Created with Neon Fury</p>
            <p>by Olympus By Merlin $Dropee</p>
            <p>-------------------</p>
            <p>Thanks for racing!</p>
            <p>May your pod never crash.</p>
            <p>-------------------</p>
            <p>Special thanks to the grid...</p>
            <p>and all the glowing gates.</p>
            <p>-------------------</p>
            <p>THE END</p>
        </div>
        <div id="skipText">CLICK OR TAP ANYWHERE TO SKIP & RESTART</div>
    </div>

    <script type="module">
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        const scoreDisplay = document.getElementById('scoreDisplay');
        const timerDisplay = document.getElementById('timerDisplay');
        const startButton = document.getElementById('startButton');
        const gameOverModal = document.getElementById('gameOverModal');
        const finalScoreDisplay = document.getElementById('finalScore');
        const modalTitle = document.getElementById('modalTitle');
        const creditsScreen = document.getElementById('creditsScreen');

        // Responsive canvas sizing
        function resizeCanvas() {
            const aspect = 3/5;
            let w = window.innerWidth * 0.9;
            let h = window.innerHeight * 0.75;
            if (w / h > aspect) w = h * aspect;
            else h = w / aspect;
            canvas.width = Math.min(w, 400);
            canvas.height = canvas.width / aspect;
            canvas.style.width = canvas.width + 'px';
            canvas.style.height = canvas.height + 'px';
        }
        window.addEventListener('resize', resizeCanvas);
        resizeCanvas();

        const GAME_DURATION = 60;
        let animationFrameId;

        let game = {
            isRunning: false,
            score: 0,
            speed: 3.5,
            maxSpeed: 12,
            speedIncreaseRate: 0.004,
            timeRemaining: GAME_DURATION,
            timerInterval: null
        };

        let pod = {
            x: 150,
            y: 440,
            width: 30,
            height: 15,
            targetX: 150,
            trackLeft: 40,
            trackRight: 260
        };

        let obstacles = [];
        let obstacleTimer = 0;
        let obstacleInterval = 90;

        function drawPod() {
            ctx.save();
            ctx.fillStyle = '#00e0ff';
            ctx.beginPath();
            ctx.moveTo(pod.x, pod.y - 10);
            ctx.lineTo(pod.x - pod.width / 2, pod.y + pod.height);
            ctx.lineTo(pod.x + pod.width / 2, pod.y + pod.height);
            ctx.closePath();
            ctx.fill();
            ctx.restore();
        }

        function drawObstacles() {
            obstacles.forEach(obs => {
                ctx.fillStyle = obs.type === 'gate' ? '#ff00ff' : '#ff8c00';
                if (obs.type === 'gate') {
                    ctx.fillRect(obs.x, obs.y, obs.width, 8);
                    ctx.fillRect(obs.x + obs.width + obs.gap, obs.y, canvas.width, 8);
                } else {
                    ctx.beginPath();
                    ctx.arc(obs.x, obs.y, 10, 0, Math.PI * 2);
                    ctx.fill();
                }
            });
        }

        function checkCollision() {
            const podLeft = pod.x - pod.width / 2;
            const podRight = pod.x + pod.width / 2;
            const podTop = pod.y - 10;
            const podBottom = pod.y + pod.height;

            for (let obs of obstacles) {
                if (podBottom >= obs.y && podTop <= obs.y + 10) {
                    if (obs.type === 'gate') {
                        if (podLeft < obs.x + obs.width || podRight > obs.x + obs.width + obs.gap) return true;
                    } else {
                        const dist = Math.hypot(pod.x - obs.x, pod.y - obs.y);
                        if (dist < 20) return true;
                    }
                }
            }
            return false;
        }

        function update() {
            if (!game.isRunning) return;
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            if (game.timeRemaining <= 0) {
                endGame("YOU SURVIVED!", true); // true = show credits
                return;
            }

            pod.x += (pod.targetX - pod.x) * 0.3;
            pod.x = Math.max(pod.trackLeft, Math.min(pod.trackRight, pod.x));

            game.score += game.speed / 15;
            scoreDisplay.textContent = `Score: ${Math.floor(game.score)}`;
            game.speed = Math.min(game.maxSpeed, game.speed + game.speedIncreaseRate);

            obstacleTimer++;
            if (obstacleTimer > obstacleInterval) {
                const gap = 85;
                const obsX = 30 + Math.random() * (canvas.width - gap - 60);
                obstacles.push({ x: 0, y: -20, width: obsX, gap: gap, type: Math.random() > 0.3 ? 'gate' : 'rock' });
                obstacleTimer = 0;
                obstacleInterval = Math.max(40, obstacleInterval - 0.2);
            }

            obstacles.forEach(o => o.y += game.speed);
            obstacles = obstacles.filter(o => o.y < canvas.height);

            if (checkCollision()) {
                endGame("POD CRASHED!", false);
                return;
            }

            drawObstacles();
            drawPod();
            animationFrameId = requestAnimationFrame(update);
        }

        function endGame(title, showCredits = false) {
            game.isRunning = false;
            cancelAnimationFrame(animationFrameId);
            clearInterval(game.timerInterval);
            modalTitle.textContent = title;
            finalScoreDisplay.textContent = Math.floor(game.score);

            if (showCredits) {
                creditsScreen.style.display = 'flex';
                // Optional: restart after credits finish (fallback)
                setTimeout(() => {
                    if (creditsScreen.style.display === 'flex') restartGame();
                }, 20000);
            } else {
                gameOverModal.style.display = 'flex';
            }
        }

        function startGame() {
            game.isRunning = true;
            game.score = 0;
            game.speed = 3.5;
            game.timeRemaining = GAME_DURATION;
            obstacles = [];
            obstacleInterval = 90;
            pod.x = canvas.width / 2;
            pod.targetX = canvas.width / 2;
            pod.trackLeft = 40;
            pod.trackRight = canvas.width - 40;
            gameOverModal.style.display = 'none';
            creditsScreen.style.display = 'none';
            timerDisplay.style.display = 'block';
            
            clearInterval(game.timerInterval);
            game.timerInterval = setInterval(() => {
                game.timeRemaining--;
                timerDisplay.textContent = `TIME: ${game.timeRemaining}`;
                if (game.timeRemaining <= 0) timerDisplay.textContent = `TIME: 0`;
            }, 1000);

            update();
        }

        function restartGame() {
            startGame();
        }

        // Input handling (updated for responsive canvas)
        function getPointerX(e) {
            const rect = canvas.getBoundingClientRect();
            const clientX = e.touches ? e.touches[0].clientX : e.clientX;
            return clientX - rect.left;
        }

        canvas.addEventListener('mousemove', e => {
            if (!game.isRunning) return;
            pod.targetX = getPointerX(e);
        });

        canvas.addEventListener('touchmove', e => {
            e.preventDefault();
            if (!game.isRunning) return;
            pod.targetX = getPointerX(e);
        }, { passive: false });

        canvas.addEventListener('mousedown', e => { if (game.isRunning) pod.targetX = getPointerX(e); });
        canvas.addEventListener('touchstart', e => {
            e.preventDefault();
            if (game.isRunning) pod.targetX = getPointerX(e);
        }, { passive: false });

        // Credits skip
        creditsScreen.addEventListener('click', restartGame);
        creditsScreen.addEventListener('touchstart', e => {
            e.preventDefault();
            restartGame();
        });

        startButton.addEventListener('click', startGame);
        window.hideModalAndRestart = restartGame;
    </script>
</body>
</html>
